!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e}(),window.triggerEvent=function(e,t,o){if(o)var n=new CustomEvent(t,{detail:o});else try{n=new Event(t)}catch(e){n=new CustomEvent(t)}return e.dispatchEvent(n,o)},window.wheelzoom=function(){function n(i,t){var u,d,m,s,c,v,l,a,o,n,r,g,e;function w(){0<v?v=0:v<d-s&&(v=d-s),0<l?l=0:l<m-c&&(l=m-c),i.style.backgroundSize=s+"px "+c+"px",i.style.backgroundPosition=v+"px "+l+"px"}function f(){s=d,c=m,v=l=0,w()}function h(e,t){void 0===t&&(t=!1);var o=i.width/2,n=i.height/2,r=(o-v)/s,a=(n-l)/c;e<0?(-1==u.maxZoom||(s+s*u.zoom)/d<=u.maxZoom)&&(s+=s*u.zoom,c+=c*u.zoom):(s-=s*u.zoom,c-=c*u.zoom),v=o-s*r,l=n-c*a,t&&(e<0?setTimeout(function(){triggerEvent(i,"wheelzoom.in",{zoom:s/d,bgPosX:v,bgPosY:l})},10):setTimeout(function(){triggerEvent(i,"wheelzoom.out",{zoom:s/d,bgPosX:v,bgPosY:l})},10)),s<=d||c<=m?triggerEvent(i,"wheelzoom.reset"):w()}function p(e){var t=0;e.preventDefault(),e.deltaY?t=e.deltaY:e.wheelDelta&&(t=-e.wheelDelta),t<0?i.doZoomIn(!0):i.doZoomOut(!0)}function E(e){e.preventDefault();var t=e.pageX-a.pageX,o=e.pageY-a.pageY,n=v+t,r=l+o;i.doDrag(n,r),triggerEvent(i,"wheelzoom.drag",{bgPosX:v,bgPosY:l,xShift:t,yShift:o}),a=e,w()}function b(){triggerEvent(i,"wheelzoom.dragend",{x:v-n,y:l-r}),document.removeEventListener("mouseup",b),document.removeEventListener("mousemove",E)}function y(e){triggerEvent(i,"wheelzoom.dragstart"),e.preventDefault(),a=e,document.addEventListener("mousemove",E),document.addEventListener("mouseup",b)}function z(){var e,t;i.src!==o&&(e=window.getComputedStyle(i,null),d=parseInt(e.width,10),m=parseInt(e.height,10),s=d,c=m,v=l=n=r=0,(t=i).style.backgroundImage='url("'+t.src+'")',t.style.backgroundRepeat="no-repeat",L.width=t.naturalWidth,L.height=t.naturalHeight,o=L.toDataURL(),t.src=o,i.style.backgroundSize=d+"px "+m+"px",i.style.backgroundPosition="0 0",i.addEventListener("wheelzoom.reset",f),i.addEventListener("wheelzoom.destroy",g),i.addEventListener("wheel",p),i.addEventListener("mousedown",y))}i&&i.nodeName&&"IMG"===i.nodeName&&(u={},i.doZoomIn=function(e){void 0===e&&(e=!1),h(-100,e)},i.doZoomOut=function(e){void 0===e&&(e=!1),h(100,e)},i.doDrag=function(e,t){v=e,l=t,w()},g=function(e){i.removeEventListener("wheelzoom.destroy",g),i.removeEventListener("wheelzoom.reset",f),i.removeEventListener("mouseup",b),i.removeEventListener("mousemove",E),i.removeEventListener("mousedown",y),i.removeEventListener("wheel",p),i.style.backgroundImage=e.backgroundImage,i.style.backgroundRepeat=e.backgroundRepeat,i.src=e.src}.bind(null,{backgroundImage:i.style.backgroundImage,backgroundRepeat:i.style.backgroundRepeat,src:i.src}),t=t||{},Object.keys(k).forEach(function(e){u[e]=void 0!==t[e]?t[e]:k[e]}),e=setInterval(function(){i.complete&&z(),clearInterval(e)},100))}var k={zoom:.1,maxZoom:-1},L=document.createElement("canvas");return"function"!=typeof window.getComputedStyle?function(e){return e}:function(e,t){if(e&&e.length)for(var o=0;o<e.length;o++)n(e[o],t);else e&&e.nodeName&&n(e,t);return e}}();